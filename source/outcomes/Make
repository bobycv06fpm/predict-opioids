Import("*")

years = Value(env.OUTCOME_YEARS)

outcomes = [
    "OUTCOME_ANY",
    "OUTCOME_DEPENDENCE",
    "OUTCOME_ABUSE",
    "OUTCOME_POISONING_RX",
    "OUTCOME_POISONING_HEROIN",
    "OUTCOME_PROCEDURE"
]

# Write separate outcome files.
for name in outcomes:
    env.Python("#scratch/outcomes/{}.csv".format(name),
               ["Outcome.py",
                "#scratch/populations/InitialRX.csv",
                "#scratch/populations/InitialOutcomes.csv",
                Value(name),
                years],
               log_path="#output/outcomes/{}.log".format(name))

# Also concatenate all outcomes into a single file.
env.Python(["#scratch/outcomes/all.csv",
            SQLTable("popioid_outcomes_all")],
           ["Concat.py"] + ["#scratch/outcomes/{}.csv".format(name) for name in outcomes])

# vim: syntax=python expandtab sw=4 ts=4
